<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NET RAPI 27 MHz 2025</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>

    <style>
        .table {
            border-collapse: collapse;
            width: 100%;
        }

        .table th, .table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        .table th {
            background-color: #f2f2f2;
        }

        .alert.alert-success {
            margin-top: 20px;
            max-width: 100%;
        }

        .custom-table tbody tr:nth-child(odd) {
            background-color: #f1f1f1;
        }

        .custom-table tbody tr:nth-child(even) {
            background-color: white;
        }

        .bi-fire {
            font-size: 20px;
            color: #ff4500;
        }

        .version {
            font-size: 0.55em;
        }

        .centered {
            text-align: center;
        }

        /* Flexbox for the input section */
        .input-container {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .input-container .form-label {
            width: 100px;
        }

        .input-container .form-control {
            width: 150px;
        }

        .button-container {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .logo {
            height: 60px; /* Increased size of logo */
            width: auto;
        }

        .title-container {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px; /* Added margin for spacing */
        }

        .title-container img:first-child {
            position: absolute;
            left: 0; /* Align left logo to the left edge */
            margin-left: 20px; /* Added space from edge */
        }

        .title-container img:last-child {
            position: absolute;
            right: 0; /* Align right logo to the right edge */
            margin-right: 20px; /* Added space from edge */
        }

        .title-container h1 {
            text-align: center;
            font-size: 2rem; /* Adjusted font size */
            margin: 0 100px; /* Added margins to ensure space for logos */
        }
    </style>
</head>

<body>
    <div class="container mt-5">
        <div class="title-container">
            <img src="rapi.png" alt="Left Logo" class="logo"> <!-- Replace with actual logo file -->
            <h1 class="display-6 centered">NET RAPI 27 MHz 2025</h1>
            <img src="net.png" alt="Right Logo" class="logo"> <!-- Replace with actual logo file -->
        </div>

        <!-- Horizontal input box row for NCS and Date Picker -->
        <div class="input-container">
            <div class="d-flex align-items-center">
                <label for="ncsCallsign" class="form-label me-2"><b>10-28 NCS:</b></label>
                <input type="text" class="form-control me-4" id="ncsCallsign" >
            </div>
            <div class="d-flex align-items-center">
                <label for="ncsDate" class="form-label me-2"><b>Tgl:</b></label>
                <input type="date" class="form-control" id="ncsDate">
            </div>
        </div>

        <table class="table table-striped borderless custom-table">
            <thead>
                <tr>
                    <th>No.</th>
                    <th>NCS</th>
                    <th>10-28</th>
                    <th>Waktu</th>
                    <th>RS</th>
                    <th>Nama</th>
                </tr>
            </thead>
            <tbody>
                <!-- Table rows are dynamically added -->
            </tbody>
        </table>

        <div class="button-container">
            <button class="btn btn-primary" id="addRowBtn"><i class="bi bi-plus-square" style="font-size: 1.2rem;"></i> Baris</button>
            <button class="btn btn-info" id="sortRowsBtn">Urutan</button>
            <button class="btn btn-warning" id="exportToExcelBtn">Simpan</button>
            <button class="btn btn-danger" id="deleteAllRowsBtn">Hapus</button>
        </div>

    </div>

    <!-- Include Bootstrap JS and Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const addRowBtn = document.getElementById("addRowBtn");
            const tableBody = document.querySelector("table tbody");
            const exportToExcelBtn = document.getElementById("exportToExcelBtn");
            const sortRowsBtn = document.getElementById("sortRowsBtn");
            const deleteAllRowsBtn = document.getElementById("deleteAllRowsBtn");
            let rowCount = 0;

            addRowBtn.addEventListener("click", function () {
                rowCount++;
                const newRow = document.createElement("tr");
                newRow.innerHTML = `  
                    <td>${rowCount}</td>
                    <td><input type="text" class="form-control" name="ncsCallsign" placeholder="NCS" required></td>
                    <td><input type="text" class="form-control" name="ncs10_28" placeholder="10-28" required></td>
                    <td><input type="text" class="form-control" name="localtime" placeholder="Waktu" required></td>
                    <td><input type="text" class="form-control" name="rs" value="59" required></td>
                    <td><input type="text" class="form-control" name="nama" placeholder="Nama" required></td>
                `;
                tableBody.appendChild(newRow);
            });

            // Sort rows by NCS (column 2)
            sortRowsBtn.addEventListener("click", function () {
                const rows = Array.from(tableBody.querySelectorAll("tr"));
                rows.sort((a, b) => {
                    const ncsA = a.querySelector("td:nth-child(2)").querySelector("input").value.toLowerCase();
                    const ncsB = b.querySelector("td:nth-child(2)").querySelector("input").value.toLowerCase();
                    return ncsA.localeCompare(ncsB);
                });

                rows.forEach(row => tableBody.appendChild(row)); // Reorder rows in the table
            });

            // Export table data to Excel
            exportToExcelBtn.addEventListener("click", function () {
                const rows = tableBody.querySelectorAll("tr");
                const data = [];

                // Get the header row
                const headers = Array.from(document.querySelectorAll("table th")).map(th => th.textContent);
                data.push(headers); // Add headers to data array

                // Get each row of data
                rows.forEach(row => {
                    const cells = row.querySelectorAll("td");
                    const rowData = [];

                    cells.forEach(cell => {
                        const input = cell.querySelector("input");
                        if (input) {
                            rowData.push(input.value); // Get input value
                        } else {
                            rowData.push(cell.textContent); // Fallback if there's no input
                        }
                    });

                    data.push(rowData);
                });

                // Create a workbook and export to Excel
                const wb = XLSX.utils.book_new();
                const ws = XLSX.utils.aoa_to_sheet(data);
                XLSX.utils.book_append_sheet(wb, ws, "Sheet1");
                XLSX.writeFile(wb, "NET_RAPI_27MHz_2025.xlsx");
            });

            // Delete all rows
            deleteAllRowsBtn.addEventListener("click", function () {
                tableBody.innerHTML = ""; // Clear the table body
            });
        });
    </script>
</body>

</html>
